<!DOCTYPE html>
<html>
	<head>
 		<!-- Meta tag for bootstrap scaling --><meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- jQuery --><script src="https://code.jquery.com/jquery-2.2.3.js" integrity="sha256-laXWtGydpwqJ8JA+X9x2miwmaiKhn8tVmOVEigRNtP4=" crossorigin="anonymous"></script>
		<!-- Bootstrap JS --> <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
		<!-- Bootstrap CSS --><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
		<!-- My CSS --><link rel="stylesheet" type="text/css" href="...">
		<title>Survey Questions</title>
	</head>

	<body>
		<div class="container-fluid">
			<h1 class = "page-header">
				Survey Questions
			</h1>
			<h2 class = "page-header">
				About You
			</h2>
			<form>
				<div class="form-group" id="nameDiv">
					<label for="name">Your Name (Required)</label>
					<input type="text" class="form-control" id="nameInput" placeholder="Name">
				</div>
				<div class="form-group" id="photoDiv">
					<label for="photo">Link to Photo Image (Required)</label>
					<input type="url" class="form-control" id="urlInput" placeholder="Image URL">
				</div>
				<h3>
					Please rank how much you agree with each of the following 10 statements
				</h3>
				<h4>
					"1" = "Strongly Disagree" <---> "5" = "Strongly Agree"
				</h4>
				
			</form>
		</div>
<!-- 
		<div class="modal fade" tabindex="-1" role="dialog" id="testModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Best Match</h4>
      </div>
      <div class="modal-body">
        <h2 id="matchName">Name</h2>
        <img id="matchImg" src="//response.photoURL" alt="//response.name">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

 -->
		<!-- My JS --><script type="text/javascript">

		var arr = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j"];
		$(document).ready(makeSurvey(arr));

			$(".btn-default").on("click", function(event){ 
				var userName = $("#nameInput").val();
				var userPhoto = $("#urlInput").val();
				var userAnswers = [];
				for (var i = 1; i <= 10; i++){
					var grabText = "input[name=options" + i +"]:checked";
					var q = $(grabText).val();
					userAnswers.push(q);
				}

				var newFriendObj = {
					name: userName, 
					photoURL: userPhoto, 
					scores: userAnswers
				}

    			// var q1 = $("input[name=options1]:checked").val();
    			console.log("newFriendObj: " + JSON.stringify(newFriendObj, null, 2))

				$.post("/api/friends", newFriendObj, function(response){
					console.log(".post response: " + JSON.stringify(response, null, 2));
					modalIt(response.name, response.photoURL);
					// $("#testModal").modal("show");
				});

				return false;
			});

			function modalIt(name, photo){
			    //Modal container divs
			  var modalMain = $("<div>").attr({
			    class: "modal fade",
			    id: "matchModal",
			    tabindex: "-1",
			    role:"dialog"
			  });
			  var modalDialog = $("<div>").attr({
			    class: "modal-dialog",
			    role:"document"
			  });
			  var modalContent = $("<div class = 'modal-content'>");

			  //Modal header
			  var modalHeader = $("<div>").attr({
			    class: "modal-header"
			  });
			  var headerText = $("<h4 class = 'modal-title'>").text("Best Match");
			  modalHeader.append(headerText);

			  //Modal body
			  var modalBody = $("<div class = 'modal-body'>");
			  var modalMatchName = $("<div id = 'matchName'>").text(name);
			  var modalIMG = $("<img>").attr({
			    id:"matchImg",
			    src: photo,
			    alt: name
			  });
			  modalBody.append(modalMatchName);
			  modalBody.append(modalIMG);

			  //Modal Footer
			  var modalFooter = $("<div class='modal-footer'>");
			  var closeButton = $("<button>").attr({
			    type:"button",
			    class:"btn btn-default",
			    "data-dismiss":"modal"
			  });
			  closeButton.text("Close");
			  modalFooter.append(closeButton);

			  //Putting it all together
			  modalMain.append(modalDialog);
			  modalMain.append(modalContent);
			  modalMain.append(modalHeader);
			  modalMain.append(modalBody);
			  modalMain.append(modalFooter);

			  $("body").append(modalMain);

			  console.log("go modal!");
			  $("#matchModal").modal("show");
			}

			function makeSurvey(inputArray){
				var radioDiv = $("<div>");
				var button = $("<button>").attr({
				type:"submit",
				class:"btn btn-default"
				});
				button.text("Submit");

				inputArray.forEach(function(currentValue, index, array){
					var questionNumber = index+1;
					var main = $("<div class='questionsDiv'>");
					var h3 = $("<h3>").text("Statement " + questionNumber);
					var h4 = $("<h4>").text(currentValue);
					main.append(h3);
					main.append(h4);

					for (var i = 1; i <= 5; i++){
					  var label = $("<label class='radio-inline'>");
					  var input = $("<input>").attr({
					    type:"radio",
					    name: "options" + questionNumber,
					    value: i
					  })

					  label.append(input);
					  main.append(label);
					}  
					radioDiv.append(main);
				})

			  $("form").append(radioDiv);
			  $("form").append($("<br>"));
			  $("form").append(button);
			  console.log("makeSurvey Done")
			}
		</script> 
	</body>
</html>